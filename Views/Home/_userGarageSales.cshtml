<head>
    <script>
        $(document).ready(function () {

            $('#userPostsList').load("/displayUserGarageSales #userPostsList", data => {
                data = JSON.parse(data);
                RenderUserPost(data);
            });



            const RenderUserPost = (data) => {
                $.each(data.data, function (i, v) {
                    @* console.log(v) *@

                        const TimeFormat = {
                        hour12: true,
                        hour: "numeric",
                        minute: "numeric", seconds: "numeric"
                    }

                    const DateFormat = {
                        weekday: "long",
                        month: "long",
                        day: "numeric"
                    };

                    const CheckDateFormat = {
                        year: "numeric",
                        month: "long",
                        day: "numeric"

                    };

                    let dateFormated = new Date(v.startDate).toLocaleDateString("en-US", DateFormat);
                    let startTimeFormatted = new Date(v.startTime).toLocaleTimeString("en-US", TimeFormat);
                    let endTimeFormatted = new Date(v.endTime).toLocaleTimeString("en-US", TimeFormat);


                    let checkDate = new Date(v.startDate).toLocaleDateString("en-US", CheckDateFormat);
                    let checkToday = new Date().toLocaleDateString("en-US", CheckDateFormat);



                    let garageItemId = v.garageSaleId;

                    if (checkDate < checkToday) {
                        console.log("this event has expired")

                    } else {
                        $(`<li id="${garageItemId}">
                        <section>
                            <header>
                                <h1>${dateFormated}</h1>
                                <h2>${startTimeFormatted}-${endTimeFormatted}</h2>
                            </header>

                              <footer>
                                <h3> ${v.city} ${v.state}</h3>
                                <p>${v.description}</p>
                            </footer>

                            <main>
                                 <a><button id="${garageItemId}" onclick="DeleteSaleHandler(event)">Delete</button></a>
                                <p>Edit</p>
                            </main>
                        </section>

                    </li>`).prependTo("#userPostsList");
                    }

                });
            };

        })

        const DeleteSaleHandler = (e) => {

            let editItem = e.target.id;

            var jsonData = {
                garageSaleId: editItem,
            }
            console.log(jsonData)

            $.ajax({
                type: "POST",
                url: '@Url.Action("DeleteSaleHandler", "Home")',
                data: jsonData,
                success: SuccessStatus,
                error: ErrorStatus,
                complete: CompleteStatus

            })


        }


        const SuccessStatus = (result) => {
            console.log("Success...", result);
        };
        const ErrorStatus = (xhr, status, strErr) => {
            console.log("There was an error!");
        };
        const CompleteStatus = (xhr, status) => {
            console.log("Ajax has completed...");
        };
    </script>
</head>


<body>


    <div id="usersGarageSalesPartial" class="userGarageSales grid-container">
        <div class="cardItems">
            <ul id="userPostsList">

            </ul>
        </div>
    </div>
</body>
